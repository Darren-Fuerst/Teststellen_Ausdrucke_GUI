
from modules.ausdrucke_functions import *

# Die relative Verlinkung ist immer vom GUI-SCRIPT aus

# reading the CSV file
df = pd.read_csv("/home/dj/Documents/Ausdrucke_GUI/Export/Covid+19-Anmeldungen.csv",encoding='latin1' ,dtype='str' ,sep=';', header=0)

df = cutoff_two_appointments(df)
df = filter_df_by_time(df, starttime=9, endtime=19)
df = sort_df_ascending(df)

# filtert und befüllt die 3 DataFrames
#tuple unpacking nötig
(df_hersbruck, df_hersbruck_pcr, df_altdorf, df_altdorf_pcr, df_lauf, df_lauf_pcr) = split_df_teststellen(df)

generate_html(df_hersbruck, "HEB_Schnelltests")
generate_html(df_hersbruck_pcr, "HEB_PCRs")
generate_html(df_altdorf, "ALD_Schnelltests")
generate_html(df_altdorf_pcr, "ALD_PCRs")
generate_html(df_lauf, "LAU_Schnelltests")
generate_html(df_lauf_pcr, "LAU_PCRs")

df_hersbruck = remove_columns(df_hersbruck)
df_hersbruck_pcr = remove_columns(df_hersbruck_pcr)
df_altdorf = remove_columns(df_altdorf)
df_altdorf_pcr = remove_columns(df_altdorf_pcr)
df_lauf = remove_columns(df_lauf)
df_lauf_pcr = remove_columns(df_lauf_pcr)

df_hersbruck = replace_headers(df_hersbruck)
df_hersbruck_pcr = replace_headers(df_hersbruck_pcr)
df_altdorf = replace_headers(df_altdorf)
df_altdorf_pcr = replace_headers(df_altdorf_pcr)
df_lauf = replace_headers(df_lauf)
df_lauf_pcr = replace_headers(df_lauf_pcr)

df_hersbruck = add_last_two_cols(df_hersbruck)
df_hersbruck_pcr = add_last_two_cols(df_hersbruck_pcr)
df_altdorf = add_last_two_cols(df_altdorf)
df_altdorf_pcr = add_last_two_cols(df_altdorf_pcr)
df_lauf = add_last_two_cols(df_lauf)
df_lauf_pcr = add_last_two_cols(df_lauf_pcr)

print_to_excel(df_hersbruck, "./Hersbruck/Listen/HEB_Liste_Schnell")
print_to_excel(df_hersbruck_pcr, "./Hersbruck/Listen/HEB_Liste_PCR")
print_to_excel(df_altdorf, "./Altdorf/Listen/ALD_Liste_Schnell")
print_to_excel(df_altdorf_pcr, "./Altdorf/Listen/ALD_Liste_PCR")
print_to_excel(df_lauf, "./Lauf/Listen/LAU_Liste_Schnell")
print_to_excel(df_lauf_pcr, "./Lauf/Listen/LAU_Liste_PCR")

duplicates_of_persons(df)